!function(){"use strict";angular.module("valdr",["ng"]).constant("valdrEvents",{revalidate:"valdr-revalidate"}).value("valdrClasses",{valid:"has-success",invalid:"has-error",dirtyBlurred:"dirty-blurred"}),angular.module("valdr").factory("valdrUtil",function(){return{isNaN:function(a){return this.isNumber(a)&&a!==+a},isNumber:function(a){var b=typeof a;return"number"===b||a&&"object"===b&&"[object Number]"===Object.prototype.toString.call(a)||!1},has:function(a,b){return a?Object.prototype.hasOwnProperty.call(a,b):!1},notEmpty:function(a){return this.isNaN(a)?!1:angular.isDefined(a)&&""!==a&&null!==a},isEmpty:function(a){return this.isNaN(a)?!1:!this.notEmpty(a)}}}),angular.module("valdr").factory("requiredValidator",["valdrUtil",function(a){return{name:"Required",validate:function(b){return a.notEmpty(b)}}}]),angular.module("valdr").factory("minValidator",["valdrUtil",function(a){return{name:"Min",validate:function(b,c){var d=Number(c.value),e=Number(b);return a.isNaN(b)?!1:a.isEmpty(b)||e>=d}}}]),angular.module("valdr").factory("maxValidator",["valdrUtil",function(a){return{name:"Max",validate:function(b,c){var d=Number(c.value),e=Number(b);return a.isNaN(b)?!1:a.isEmpty(b)||d>=e}}}]),angular.module("valdr").factory("sizeValidator",function(){return{name:"Size",validate:function(a,b){var c=b.min||0,d=b.max;return a=a||"",a.length>=c&&(void 0===d||a.length<=d)}}}),angular.module("valdr").factory("emailValidator",["valdrUtil",function(a){var b=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i;return{name:"Email",validate:function(c){return a.isEmpty(c)||b.test(c)}}}]),angular.module("valdr").factory("digitsValidator",["valdrUtil",function(a){var b=1.1.toLocaleString().substring(1,2),c=function(a){var c=new RegExp("[^"+b+"\\d]","g");return a.toString().replace(c,"")},d=function(a,b){return a?a.length<=b:!0},e=function(a,e){var f,g,h=e.integer,i=e.fraction;return f=c(a),g=f.split(b),d(g[0],h)&&d(g[1],i)};return{name:"Digits",validate:function(b,c){return a.isEmpty(b)?!0:a.isNaN(Number(b))?!1:e(b,c)}}}]),angular.module("valdr").factory("pastValidator",["futureAndPastSharedValidator",function(a){return{name:"Past",validate:function(b){return a.validate(b,function(a,b){return a.isBefore(b)})}}}]),angular.module("valdr").factory("futureValidator",["futureAndPastSharedValidator",function(a){return{name:"Future",validate:function(b){return a.validate(b,function(a,b){return a.isAfter(b)})}}}]),angular.module("valdr").factory("patternValidator",["valdrUtil",function(a){var b=/^\/(.*)\/([gim]*)$/,c=function(a){var c;if(a.test)return a;if(c=a.match(b))return new RegExp(c[1],c[2]);throw"Expected "+a+" to be a RegExp"};return{name:"Pattern",validate:function(b,d){var e=c(d.value);return a.isEmpty(b)||e.test(b)}}}]),angular.module("valdr").provider("valdr",function(){var a,b,c={},d={},e={},f=["requiredValidator","sizeValidator","minValidator","maxValidator","emailValidator","digitsValidator","patternValidator"],g=function(a){angular.extend(c,a)};this.addConstraints=g,this.setConstraintUrl=function(b){a=b},this.addValidator=function(a){f.push(a)},this.addConstraintAlias=function(a,b){e[a]=b},this.$get=["$log","$injector","$rootScope","$http","valdrEvents","valdrUtil","valdrClasses",function(h,i,j,k,l,m,n){angular.forEach(f,function(a){var b=i.get(a),c=e[b.name]||b.name;d[c]=b}),a&&(b=!0,k.get(a).then(function(a){b=!1,g(a.data),j.$broadcast(l.revalidate)}).finally(function(){b=!1}));var o=function(a){return m.has(c,a)?c[a]:void(b||h.warn("No constraints for type '"+a+"' available."))};return{validate:function(a,b,c){var e={valid:!0},f=o(a);if(m.has(f,b)){var g=f[b],i=!0,j=[];return angular.forEach(g,function(f,g){var k=d[g];if(angular.isUndefined(k))return h.warn("No validator defined for '"+g+"'. Can not validate field '"+b+"'"),e;var l=k.validate(c,f);if(!l){var m={value:c,field:b,type:a,validator:g};angular.extend(m,f),j.push(m)}i=i&&l}),{valid:i,violations:0===j.length?void 0:j}}return e},addConstraints:function(a){g(a),j.$broadcast(l.revalidate)},getConstraints:function(){return c},setClasses:function(a){angular.extend(n,a),j.$broadcast(l.revalidate)}}}]}),angular.module("valdr").directive("valdrType",function(){return{priority:1,controller:["$attrs",function(a){this.getType=function(){return a.valdrType}}]}});var a=["valdrEvents","valdr","valdrUtil","valdrClasses",function(a,b,c,d){return{restrict:"E",require:["?^valdrType","?^ngModel"],link:function(e,f,g,h){var i=h[0],j=h[1],k=g.name,l=f.parent();if(i&&j){if(c.isEmpty(k))throw new Error("form element is not bound to a field name");var m=function(a){l.addClass(a?d.valid:d.invalid),l.removeClass(a?d.invalid:d.valid)},n=function(a){j.$setValidity("valdr",a.valid),j.valdrViolations=a.violations},o=function(a){var c=b.validate(i.getType(),k,a);return n(c),m(c.valid),c.valid?a:void 0};j.$parsers.push(o),j.$formatters.push(o),e.$on(a.revalidate,function(){o(j.$viewValue)}),f.bind("blur",function(){j.$invalid&&j.$dirty&&l.addClass(d.dirtyBlurred)})}}}}];angular.module("valdr").directive("input",a).directive("select",a)}(window,document);