!function(){"use strict";angular.module("valdr",["ng"]).constant("valdrEvents",{rulesChanged:"nca-model-validation-rules-changed"}),angular.module("valdr").factory("valdrUtil",function(){return{isNaN:function(a){return this.isNumber(a)&&a!==+a},isNumber:function(a){var b=typeof a;return"number"===b||a&&"object"===b&&"[object Number]"===Object.prototype.toString.call(a)||!1},has:function(a,b){return a?Object.prototype.hasOwnProperty.call(a,b):!1},forOwn:function(a,b){var c;for(c in a)a.hasOwnProperty(c)&&b(c,a[c])}}}),angular.module("valdr").factory("validationUtil",["valdrUtil",function(a){return{notNull:function(b){return angular.isDefined(b)&&""!==b&&null!==b&&!a.isNaN(b)},result:function(a,b,c){return{valid:a,messageKey:b,messageParams:c}}}}]),angular.module("valdr").factory("requiredValidator",["validationUtil",function(a){return{name:"Required",validate:function(b,c){var d=a.notNull(c);return a.result(d,b.message)}}}]),angular.module("valdr").factory("sizeValidator",["validationUtil",function(a){return{name:"Size",validate:function(b,c){var d=b.min||0,e=b.max;c=c||"";var f=c.length>=d&&(void 0===e||c.length<=e),g={min:d,max:e};return a.result(f,b.message,g)}}}]),angular.module("valdr").provider("valdrValidator",function(){var a,b={},c={},d=[],e=function(a){angular.extend(b,a)};this.addValidationRules=e,this.setValidationRulesUrl=function(b){a=b},this.addValidator=function(a){d.push(a)},this.addValidator("sizeValidator"),this.addValidator("requiredValidator"),this.$get=["$log","$injector","$rootScope","$http","valdrEvents","valdrUtil",function(f,g,h,i,j,k){angular.forEach(d,function(a){var b=g.get(a);c[b.name]=b}),a&&i.get(a).then(function(a){e(a.data),h.$broadcast(j.rulesChanged)});var l=function(a){return k.has(b,a)?b[a]:void f.warn("No validation rules for type "+a+" available.")},m={valid:!0};return{validate:function(a,b,d){var e=l(a);if(k.has(e,b)){var g=e[b],h=!0,i=[];return k.forOwn(g,function(a,e){var g=c[a];if(angular.isUndefined(g))return f.warn("No validator defined for '"+a+"'. Can not validate field "+b),m;var j=c[a].validate(e,d);j.valid||i.push(j),h=h&&j.valid}),{valid:h,messages:i}}return m},addValidationRules:function(a){e(a),h.$broadcast(j.rulesChanged)},getValidationRules:function(){return b}}}]}),angular.module("valdr").directive("valdrType",function(){return{controller:function(){var a;this.setType=function(b){a=b},this.getType=function(){return a}},priority:1,link:function(a,b,c,d){d.setType(c.valdrType)}}}),angular.module("valdr").directive("input",["valdrEvents","valdrValidator",function(a,b){return{restrict:"E",require:["?^valdrType","?^ngModel"],link:function(c,d,e,f){var g=f[0],h=f[1],i=e.name;if(g&&h){if(!angular.isString(i)||0===i.length)throw new Error("input is not bound to a field name");var j=function(a){h.$setValidity("valdrValidator",a.valid),h.valdrMessages=a.messages},k=function(a){var c=b.validate(g.getType(),i,a);return j(c),c.valid?a:void 0};h.$parsers.push(k),h.$formatters.push(k),c.$on(a.rulesChanged,function(){k(h.$viewValue)})}}}}])}(window,document);