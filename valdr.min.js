!function(){"use strict";angular.module("valdr",["ng"]).constant("valdrEvents",{revalidate:"valdr-revalidate"}).value("valdrClasses",{valid:"has-success",invalid:"has-error",dirtyBlurred:"dirty-blurred",formGroup:"form-group"}),angular.module("valdr").factory("valdrUtil",["valdrClasses",function(a){return{isNaN:function(a){return this.isNumber(a)&&a!==+a},isNumber:function(a){var b=typeof a;return"number"===b||a&&"object"===b&&"[object Number]"===Object.prototype.toString.call(a)||!1},has:function(a,b){return a?Object.prototype.hasOwnProperty.call(a,b):!1},notEmpty:function(a){return this.isNaN(a)?!1:angular.isDefined(a)&&""!==a&&null!==a},isEmpty:function(a){return this.isNaN(a)?!1:!this.notEmpty(a)},findWrappingFormGroup:function(b){for(var c=b.parent(),d=0;3>d;d++){if(c.hasClass(a.formGroup))return c;c=c.parent()}return b.parent()}}}]),angular.module("valdr").factory("valdrRequiredValidator",["valdrUtil",function(a){return{name:"required",validate:function(b){return a.notEmpty(b)}}}]),angular.module("valdr").factory("valdrMinValidator",["valdrUtil",function(a){return{name:"min",validate:function(b,c){var d=Number(c.value),e=Number(b);return a.isNaN(b)?!1:a.isEmpty(b)||e>=d}}}]),angular.module("valdr").factory("valdrMaxValidator",["valdrUtil",function(a){return{name:"max",validate:function(b,c){var d=Number(c.value),e=Number(b);return a.isNaN(b)?!1:a.isEmpty(b)||d>=e}}}]),angular.module("valdr").factory("valdrSizeValidator",function(){return{name:"size",validate:function(a,b){var c=b.min||0,d=b.max;return a=a||"",a.length>=c&&(void 0===d||a.length<=d)}}}),angular.module("valdr").factory("valdrEmailValidator",["valdrUtil",function(a){var b=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i;return{name:"email",validate:function(c){return a.isEmpty(c)||b.test(c)}}}]),angular.module("valdr").factory("valdrUrlValidator",["valdrUtil",function(a){var b=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;return{name:"url",validate:function(c){return a.isEmpty(c)||b.test(c)}}}]),angular.module("valdr").factory("valdrDigitsValidator",["valdrUtil",function(a){var b=1.1.toLocaleString().substring(1,2),c=function(a){var c=new RegExp("[^"+b+"\\d]","g");return a.toString().replace(c,"")},d=function(a,b){return a?a.length<=b:!0},e=function(a,e){var f,g,h=e.integer,i=e.fraction;return f=c(a),g=f.split(b),d(g[0],h)&&d(g[1],i)};return{name:"digits",validate:function(b,c){return a.isEmpty(b)?!0:a.isNaN(Number(b))?!1:e(b,c)}}}]),angular.module("valdr").factory("futureAndPastSharedValidator",["valdrUtil",function(a){var b=["D-M-YYYY","D.M.YYYY","D/M/YYYY","D. M. YYYY","YYYY.M.D"];return{validate:function(c,d){var e,f=moment();if(a.isEmpty(c))return!0;e=moment(c);for(var g=0;g<b.length&&!e.isValid();g++)e=moment(c,b[g],!0);return e.isValid()&&d(e,f)}}}]),angular.module("valdr").factory("valdrPastValidator",["futureAndPastSharedValidator",function(a){return{name:"past",validate:function(b){return a.validate(b,function(a,b){return a.isBefore(b)})}}}]),angular.module("valdr").factory("valdrFutureValidator",["futureAndPastSharedValidator",function(a){return{name:"future",validate:function(b){return a.validate(b,function(a,b){return a.isAfter(b)})}}}]),angular.module("valdr").factory("valdrPatternValidator",["valdrUtil",function(a){var b=/^\/(.*)\/([gim]*)$/,c=function(a){var c;if(a.test)return a;if(c=a.match(b))return new RegExp(c[1],c[2]);throw"Expected "+a+" to be a RegExp"};return{name:"pattern",validate:function(b,d){var e=c(d.value);return a.isEmpty(b)||e.test(b)}}}]),angular.module("valdr").factory("valdrMinLengthValidator",["valdrUtil",function(a){return{name:"minLength",validate:function(b,c){var d=c.number;return a.isEmpty(b)?0===d:"string"==typeof b?b.length>=d:!1}}}]),angular.module("valdr").factory("valdrMaxLengthValidator",["valdrUtil",function(a){return{name:"maxLength",validate:function(b,c){var d=c.number;return a.isEmpty(b)?!0:"string"==typeof b?b.length<=d:!1}}}]),angular.module("valdr").factory("valdrHibernateEmailValidator",["valdrUtil",function(a){var b="[a-z0-9!#$%&'*+/=?^_`{|}~-]",c="^"+b+"+(\\."+b+"+)*$",d="^\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\]$",e=new RegExp("^"+b+"+(\\."+b+"+)*$","i"),f=new RegExp(c+"|"+d,"i");return{name:"hibernateEmail",validate:function(b){if(a.isEmpty(b))return!0;var c=b.split("@");return 2!==c.length?!1:e.test(c[0])?f.test(c[1]):!1}}}]),angular.module("valdr").provider("valdr",function(){var a,b,c={},d={},e={},f=["valdrRequiredValidator","valdrSizeValidator","valdrMinLengthValidator","valdrMaxLengthValidator","valdrMinValidator","valdrMaxValidator","valdrEmailValidator","valdrUrlValidator","valdrDigitsValidator","valdrFutureValidator","valdrPastValidator","valdrPatternValidator","valdrHibernateEmailValidator"],g=function(a){angular.extend(c,a)};this.addConstraints=g,this.setConstraintUrl=function(b){a=b},this.addValidator=function(a){f.push(a)},this.addConstraintAlias=function(a,b){e[a]=b},this.$get=["$log","$injector","$rootScope","$http","valdrEvents","valdrUtil","valdrClasses",function(h,i,j,k,l,m,n){angular.forEach(f,function(a){var b=i.get(a),c=e[b.name]||b.name;d[c]=b}),a&&(b=!0,k.get(a).then(function(a){b=!1,g(a.data),j.$broadcast(l.revalidate)})["finally"](function(){b=!1}));var o=function(a){return m.has(c,a)?c[a]:void(b||h.warn("No constraints for type '"+a+"' available."))};return{validate:function(a,b,c){var e={valid:!0},f=o(a);if(m.has(f,b)){var g=f[b],i=!0,j=[];return angular.forEach(g,function(f,g){var k=d[g];if(angular.isUndefined(k))return h.warn("No validator defined for '"+g+"'. Can not validate field '"+b+"'"),e;var l=k.validate(c,f);if(!l){var m={value:c,field:b,type:a,validator:g};angular.extend(m,f),j.push(m)}i=i&&l}),{valid:i,violations:0===j.length?void 0:j}}return e},addConstraints:function(a){g(a),j.$broadcast(l.revalidate)},getConstraints:function(){return c},setClasses:function(a){angular.extend(n,a),j.$broadcast(l.revalidate)}}}]}),angular.module("valdr").directive("valdrType",function(){return{priority:1,controller:["$attrs",function(a){this.getType=function(){return a.valdrType}}]}});var a=["valdrEvents","valdr","valdrUtil","valdrClasses",function(a,b,c,d){return{restrict:"E",require:["?^valdrType","?^ngModel"],link:function(e,f,g,h){var i,j=h[0],k=h[1],l=g.name;if(j&&k){if(c.isEmpty(l))throw new Error("form element is not bound to a field name");i=c.findWrappingFormGroup(f);var m=function(a){i.toggleClass(d.valid,a),i.toggleClass(d.invalid,!a)},n=function(a){k.$setValidity("valdr",a.valid),k.valdrViolations=a.violations},o=function(a){var c=b.validate(j.getType(),l,a);return n(c),m(c.valid),c.valid?a:void 0};k.$parsers.push(o),k.$formatters.push(o),e.$on(a.revalidate,function(){o(k.$modelValue)}),f.bind("blur",function(){k.$invalid&&k.$dirty&&i.addClass(d.dirtyBlurred)})}}}}];angular.module("valdr").directive("input",a).directive("select",a).directive("textarea",a)}(window,document);